# 와 생각보다 코드가 엄청 더럽스

생각대로 코딩하면 정말 안되겠다라는 생각이 많이든다. 장군 로직을 구현했으니 멍군 로직과 다른 로직을 구현해야 한다.

만약 `장군`을 구현했다면, `장군` 에서 `외통수`로 가는 로직을 생각해 봐야 한다.

지금 내가 생각하고 있는 로직은 다음과 같다.

1. 유닛이 이동하며, 어떤 좌표에 놓여진다.
2. 놓여진 좌표에서 그 유닛이 이동 할 수 있는 공간들을 확인한다.
3. 그 공간들 중 왕이 있다면 장군이다.  
   1. 장군일 때, 장군을 막을 수 있는 유닛들만 이동처리 해야한다.  
   2. 장군일 때, 왕의 이동경로를 저장한다.
        1. 왕이 이동했을 때, 상대방 모든 유닛들의 이동 할 수 있는 공간을 체크한다.
        2. 만약 왕의 이동경로가 포함된다면 그 경로는 선택 할 수 없다.
   3. 왕의 이동 공간이 막혀있다면
      1. 아군의 유닛 들 중, 장군을 부른 기물의 특정 경로를 막을 수 있는지 확인한다. 만약 어떤 아군도 특정 경로를 막지 못한다면 외통수이다.
      2. 아군의 유닛이 장군을 부른 기물의 특정 경로를 막을 수 있지만, 그 이동이 다른 장군을 부를 경우 그 유닛은 이동 할 수 없다.

이 경우, 어떤 유닛의 이동 경로를 찾는 로직에서, 그 유닛이 움직였을 때, 상대방 기물이 바로 왕을 공격 할 수 있는 경우 해당 이동 경로를 제외하는 로직을 추가 구현해야 겠다.

또한, 장군을 당했을 때 장군을 막을 수 있는 유닛을 이동하는게 아닌 이상한 유닛을 이동하려는 인터랙션도 막아야 한다.

생각보다 로직이 복잡하고, 다양한 조건을 확인 해 봐야 한다. 이 때 설계가 제대로 되지 않았기 때문에, 필요한 데이터를 추가하고 변경 할 경우 의존성이 있는 부분들도 같이 바꿔줘야 하기 때문에 에러를 잡는데 많은 시간이 소요되고 있다.

멍군, 외통수 로직은 시간이 많이 걸리기 때문에, 소리를 넣는 로직과 더불어 시간초와 턴을 넘기는 로직, 초세기를 더 넣어봐야 겠다.